// Generated by CoffeeScript 1.6.2
(function() {
  define(function() {
    var TTL, _default_ref;

    TTL = 1000 * 60 * 60 * 3;
    _default_ref = "518b989739ed9714289d0bc1";
    return {
      _getName: function(ref) {
        if (!ref) {
          ref = _default_ref;
        }
        return "graph_" + ref;
      },
      _auth: function() {
        return true;
      },
      get: function(filter) {
        var d;

        if (filter.context !== "data") {
          console.log("get graph cache : " + this._getName(filter.graph));
          d = $.jStorage.get(this._getName(filter.graph));
          if (d) {
            return JSON.parse(d);
          } else {
            return null;
          }
        }
      },
      update: function(method, req_data, res_data) {
        var ref, _data;

        if (method === "get") {
          if (!req_data || req_data.context !== "data") {
            console.log("update graph cache : " + res_data.id);
            _data = JSON.stringify(res_data);
            return $.jStorage.set(this._getName(res_data.id), _data, {
              TTL: TTL
            });
          }
        } else {
          console.log("swap user after any NOT PUT graph update");
          $.jStorage.deleteKey("curUser");
          ref = req_data.graph;
          if (ref == null) {
            ref = req_data.id;
          }
          if (ref == null) {
            ref = req_data.ref;
          }
          console.log("swap graph after any graph update " + ref);
          return $.jStorage.deleteKey(this._getName(ref));
        }
      }
    };
  });

}).call(this);

/*
//@ sourceMappingURL=graph.map
*/
